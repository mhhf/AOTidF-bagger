% Article template for Mathematics Magazine
% Revised 7/2002  Thanks for Greg St. George
\documentclass[12pt]{article}
\usepackage{amssymb}
\usepackage[ngerman]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{dot2texi}
\usetikzlibrary{shapes,arrows}
\renewcommand{\baselinestretch}{1.2}
%This is the command that spaces the manuscript for easy reading


%todo
\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}
\usepackage{xargs}                      % Use more than one optional parameter in a new commands
\newcommandx{\QUESTION}[2][1=]{\todo[linecolor=none,backgroundcolor=blue!15,bordercolor=none,#1]{\textbf{QUESTION: }#2}}
\newcommandx{\TODO}[2][1=]{\todo[inline,linecolor=none,backgroundcolor=blue!15,bordercolor=none,#1]{\textbf{TODO: }#2}}

\newtheoremstyle{break}
  {\topsep} {\topsep}%
  {}{}%
  {\bfseries}{:}%
  {\newline}{}%
\theoremstyle{break}
\newtheorem{zeige}{Zeige}
\newtheorem{definition}{Definition}
\newtheorem{bsp}{Beispiel}
\newtheorem{thm}{Theorem}



\begin{document}
%\thispagestyle{empty}
\title{AOTidf Bagger Game}
\author{Denis Erfurt, Tobias Behrens}

\begin{abstract}
  \noindent
  In dieser Arbeit zeigen wir, dass es sich bei dem \textsc{Coalition Skill Game} (CSG) um ein superadditives Spiel handelt. Bei einem superadditives Spiel ist die große Koalition zwangsläufig die beste Strategie, um den Gewinn aller Agenten zu maximieren. Um diesen Zusammenhang aufzuzeigen, formalisieren wir zunächst das in der Aufgabenstellung beschriebene Spiel: So können wir zeigen, dass jedes CSG bezüglich seiner Strategien equivalent ist zu einem Spiel, in dem jeder Agent nur über eine Skillkapazität verfügt. Anschließend zeigen wir die Superadditivitätseigenschaft für das Spiel und geben ein Algorithmus an, der die optimale Ressourcenverteilung aus der Sicht der Agenten berechnet.
\end{abstract}



\maketitle


\section{Voraussetzungen}
Um das gegebene Problem strukturell analysieren zu können, benutzen wir die Sprache der HOL (Higher Order Logic). Zunächst werden wir in (\ref{sigmod}) vier Signaturen mit den dazugehörigen Modellklassen einführen, auf denen das Problem analysiert wird. Anschließend werden wir in (\ref{bez}) Beziehungen zwischen den Modellklassen betrachten und schließlich in (\ref{supadd}) die Superadditivität des Spiels zeigen.
\\
\TODO{Vereinfachungen - fixes binäres budget}


\subsection{Grundlagen}
\TODO{HOL}
  Im weiteren Verlauf der Arbeit werden Funktionen mit kleinem Anfangsbuchstaben und Relationen mit einem großen Anfangsbuchstaben geschrieben. Ebenfalls gehen wir davon aus, dass alle Funktionen total und mit 0 initialisiert sind, falls für eine Struktur Eingabeparameter nicht näher definiert wurden. Wir verwenden die Schreibweise in Prädikatenlogik und die Mengenschreibweise equivalent: $a\in A \equiv A(a)$

\subsection{Terminologie}
\label{sigmod}

\subsubsection{Signaturen und Modellklassen}
Wir führen nun vier verschiedene Signaturen mit den dazugehörigen Modellklassen ein:
\begin{enumerate}
  \item \textbf{CSGS} - Coalition Skill Game Setting
  \item \textbf{CSG} - Coalition Skill Game
  \item \textbf{SCSGS} - Simple Coalition Skill Game Setting
  \item \textbf{SCSG} - Simple Coalition Skill Game
\end{enumerate}

\begin{definition}[CSGS]
  Eine \textsc{Coalitional Skill Game Setting}-Signatur (CSGS-Signatur) sei definiert als
  \begin{align*}
    &\sigma_{CSGS}:= \\
    &\{Agent_{/1}, Baustelle_{/1}, supply_{/2}, demand_{/2}, budget_{/1}, kosten_{/4} \}
  \end{align*}
  \noindent
  \textbf{Intuition} \\
    \begin{tabular}{lrl}
    $Agent(x)$&$:\Leftrightarrow$& $x$ ist ein Agent (Baufirma) \\
    $Baustelle(x) $&$:\Leftrightarrow$& $x$ ist eine Baustelle \\
    $supply(x, t)\mapsto n $&$:\Leftrightarrow$& Agent $x$ besitzt $n$ Einheiten vom Skilltyp $t$ \\
    $demand(x, t)\mapsto n $&$:\Leftrightarrow$& Baustelle $x$ benötigt $n$ Einheiten vom Skilltyp $t$ \\
    $budget(x)\mapsto n $&$:\Leftrightarrow$&
    Baustelle $x$ ist bereit einen Gewinn von \\&&maximal $n$ bei Fertigstellung auszuzahlen\\
    $kosten(t, n, x, y)\mapsto n$&$:\Leftrightarrow$& Kosten für Agenten $x$ für den Transport von \\&&$n$ Einheiten des Skilltyp $t$ an die Baustelle $y$.
    \end{tabular}
\end{definition}

\noindent
Im folgenden werden wir die $\sigma_{CSGS}$-Struktur $\mathcal{S}$ als ein Setting bezeichnen. Die Modellklasse $M_{CSGS}$ steht für die Gesamtheit an validen Settings.
Auf eine formale Definition der Validität eines Settings -- z.B. \textit{die Menge der Baustellen und Agenten sind disjunkt} -- wird verzichtet.

\newpage \noindent
Beispielhaft ein Setting für ein gegebenes Szenario:
\begin{bsp}
  Sei $\mathcal{S}$ eine $\sigma_{CSGS}-$Struktur mit:\\
  
  \noindent
  \setlength{\tabcolsep}{24pt}
  \begin{tabular}{l|l}
    $Agent^\mathcal{S} := \{a_1, a_2, a_3\}$ & $Baustelle^\mathcal{S} := \{b_1, b_2\}$ \\
    $supply^\mathcal{S}(a_1, t_1)\mapsto 2 $ & $demand^\mathcal{S}(b_1, t_1)\mapsto 10$\\
    $supply^\mathcal{S}(a_1, t_2)\mapsto 7 $ & $demand^\mathcal{S}(b_1, t_2)\mapsto 5 $\\
    $supply^\mathcal{S}(a_2, t_1)\mapsto 3 $ & $demand^\mathcal{S}(b_2, t_1)\mapsto 2 $\\
    $supply^\mathcal{S}(a_2, t_2)\mapsto 5 $ & $demand^\mathcal{S}(b_2, t_2)\mapsto 2 $\\
    $supply^\mathcal{S}(a_3, t_1)\mapsto 20$ & $budget^\mathcal{S}(b_1)\mapsto 10$\\
    $supply^\mathcal{S}(a_3, t_2)\mapsto 5 $ & $budget^\mathcal{S}(b_2)\mapsto 3 $\\
  \end{tabular}
\end{bsp}

\begin{definition}[CSG]
  Eine \textsc{Coalitional Skill Game}-Signatur (CSG-Signatur) sei definiert als
  \begin{align*}
    \sigma_{CSG}:=\sigma_{CSGS}\cup\{m_{/3}, v_{/2}\}   
  \end{align*}
  \noindent
  \textbf{Intuition} \\
    \begin{tabular}{lrl}
    $m(x, t, y)\mapsto n$&$:\Leftrightarrow$& Agent $x$ sendet $n$ Einheiten des Skilltyps $t$ an \\&&die Baustelle $y$ \\
    $v(x,y)\mapsto n$&$:\Leftrightarrow$& Agent $x$ erhält von Baustelle $y$ die Vergütung $n$
    \end{tabular}
\end{definition}

\noindent
Wir bezeichnen eine $\sigma_{CSG}$-Struktur als ein Game $\mathcal{G}$. Intuitiv ist ein Game ein valides Setting mit einer möglichen validen Lösung: eine mögliche Verteilung der verfügbaren Skills der Baufirmen mit entsprechender Vergütungen der Baustellen.

$M_CSG$ bezeichnen wir als Klasse aller valider Games. Hier wird ebenfalls auf eine formale Definition valider Kriterien verzichtet. Informell seien aber die wichtigsten Aspekte der Validität kurz beschrieben: Ein Agent kann nicht mehr Einheiten eines Skills ausgeben als er besitzt; Eine Baustelle kann nicht mehr Geld ausgeben, als sie besitzt; Eine Baustelle gibt nur Geld aus, falls sie vollständig mit den benötigten Skills versorgt wird.

\newpage
\begin{bsp}
  Sei $\mathcal{G}$ eine Erweiterung der $\sigma_{CSG}$-Struktur $\mathcal{S}$ mit: \\
  
  \noindent
  \setlength{\tabcolsep}{24pt}
  \begin{tabular}{l|l}
    $m(a_1, t_1, b_1) \mapsto 2 $&$ m(a_1, t_2, b_1) \mapsto 5$ \\
    $m(a_2, t_1, b_1) \mapsto 3 $&$ m(a_3, t_1, b_1) \mapsto 5$ \\
    $m(a_3, t_1, b_2) \mapsto 2 $&$ m(a_3, t_2, b_2) \mapsto 2$
  \end{tabular}
\end{bsp}

\noindent
Wir zeigen später, dass sich jedes Setting bzw. Game zu einem Setting bzw. Game vereinfachen lässt, in dem jeder Agent nur eine Skillkapazität besitzt. Diese Vereinfachung erleichtert uns den Beweis der Superadditivität und die Betrachtung möglicher Algorithmen zur Verteilungsberechnung. Hierfür benötigen wir jedoch die neue Relation $AgentOwner_{/2}$, mit der wir uns die Zuteilung einer Skillkapazität zu seinem ursprünglichen Agenten merken.

\begin{definition}[SCSGS]
  Eine \textsc{Simple Coalition Skill Game Setting}-Signatur sei definiert als
  \begin{align*}
    &\sigma_{SCSGS}:= \\
    &\{gentOwner_{2}, Agent_{/1}, Baustelle_{/1}, supply_{/2}, demand_{/2}, budget_{/1}, kosten_{/4} \}
  \end{align*}
  \noindent
  \textbf{Intuition} \\
    \begin{tabular}{lrl}
    $AgentOwner(a, x)$&$:\Leftrightarrow$& Agent $x$ gehört zu dem ursprüngl. Agenten $a$ \\
    $Agent(x)$&$:\Leftrightarrow$& $x$ ist ein Agent (Baufirma) \\
    $Baustelle(x) $&$:\Leftrightarrow$& $x$ ist eine Baustelle \\
    $supply(x, t)\mapsto n $&$:\Leftrightarrow$& Agent $x$ besitzt $n$ Einheiten vom Skilltyp $t$ \\
    $demand(x, t)\mapsto n $&$:\Leftrightarrow$& Baustelle $x$ benötigt $n$ Einheiten vom Skilltyp $t$ \\
    $budget(x)\mapsto n $&$:\Leftrightarrow$&
    Baustelle $x$ ist bereit einen Gewinn von \\&&maximal $n$ bei Fertigstellung auszuzahlen\\
    $kosten(t, n, x, y)\mapsto n$&$:\Leftrightarrow$& Kosten für Agenten $x$ für den Transport von \\&&$n$ Einheiten des Skilltyp $t$ an die Baustelle $y$.
    \end{tabular}
\end{definition}

\noindent
Wir bezeichnen eine $\sigma_{SCSGS}$-Struktur $\mathcal{SS}$ als \textit{Simple Setting} und die dazugehörige Modellklasse valider Strukturen $M_{SCSGS}$. Auch hier werden wir die Validitätskriterien nicht weiter erläutern.

\begin{definition}[SCSG]
  Eine \textsc{Simple Coalition Skill Game}-Signatur (SCSG) sei definiert als
  \begin{align*}
    \sigma_{SCSG}:=\sigma_{SCSGS}\cup\{M_{/3}, v_{/2}\}
  \end{align*}
  \noindent
  \textbf{Intuition} \\
    \begin{tabular}{lrl}
    $m(x, t, y)\mapsto n$&$:\Leftrightarrow$& Agent $x$ sendet $n$ Einheiten des Skilltyps $t$ an \\&&die Baustelle $y$ \\
    $v(x,y)\mapsto n$&$:\Leftrightarrow$& Agent $x$ erhält von Baustelle $y$ die Vergütung $n$
    \end{tabular}
\end{definition}

\noindent
Wir bezeichnen eine $\sigma_{SCSG}$-Struktur $\mathcal{SG}$ als \textit{Simple Game} mit der dazugehörigen validen Modelklasse $M_{SCSG}$. Validitätskriterien werden an dieser Stelle nicht weiter betrachtet.


\subsection{bez}
\label{bez}

Bei der gegebenen Aufgabenstellung interessieren wir uns für ein Mechanismus der bei eiem gegebenen Setting ein Game berechnet. Formal gesehen:

\begin{equation}
  m: M_{CSGS} \leftarrow M_{CSG}
\end{equation}

Nach welchen Kritärien dieser mechanismus arbeitet und bewertet wird wird vorest offen gelassen.\\

Die nachfolgenden Betrachtungen wollen wir jedoch auf einer vereinfachten Strukturen machen, bei denen jeder Agent nur eine Ressource besitzt. Um dennoch aussagen über CSG machen zu können werden wir zeigen dass jedes Setting bzw. Game zu einem Simple Setting bzw. Simple Game überführen lässt. Dieses erlaubt uns auch die betrachtung von mechanismen die bei einem Simple Setting ein Simple Game berechnen. Formal:

\[
\begin{tikzcd}[column sep=1in,row sep=1in]
M_{CSGS} \arrow{d}{\pi} \arrow{r}{\pi'^{-1}\ \circ\  m'\ \circ\ \pi} & M_{CSG} \\
M_{SCSGS} \arrow{r}{m'} & M_{SCSG} \arrow{u}{\pi'^{-1}}
\end{tikzcd}
\]

Dabei müssen folgende Eigenschaften gelten:


\begin{eqnarray}
  \pi &-&\text{total, injektiv} \\
  \pi^{-1}&-&\text{surjektiv} \\
  \pi' &-&\text{total, injektiv} \\
  \pi'^{-1}&-&\text{surjektiv} \\
  \pi^{-1}\circ\pi &=& id_{M_{CSGS}} \\
  \pi'^{-1}\circ\pi' &=& id_{M_{CSG}} \\
\end{eqnarray}

Weiter werden wir nur Mechanismen betrachten die nichts am Setting ändern sondern nur matchings und vergütungsverteilung berechnen.
Auf eine ausführliche Definition der gesuchten Funktionen wird hier ebenfalls verzichtet. Statdessen wird eine intuition gegeben: Ein Setting bzw. Game lässt sich in ein Simple Setting bzw. Simple Game überführen indem jede ressource eines Agenten als eigenständiger Agent betrachtet wird wobei die zugehörigkeit von agenten unr Resourcen sich in der $AgentOwner$ Relation gemerkt wird. Kostenfunktion bleibt dabei bestehen und wird lediglich auf die Agentbesitzer übertragen. Bei den Matches sowie vergütung wird ähnlich verfahren. Hierdurch gehen keine informationen verlohren und alle Betrachtungen können auf den vereifachten Modellen durchgeführt werden.
\subsection{supadd}
\label{supadd}

Um die Superadditivität des Spieles zu zeigen werden zunächst der Begriffe formal festgehalten:

\begin{definition}
  Sei $K\subseteq A$ eine beliebige Koalition. Wir definieren die Menge $PM(K)$ der potentiellen Matches:
  \begin{eqnarray}
    PM(K) := \{ &\\
    &m: Agent\times Resource \times Baustelle \rightarrow \mathbb{N}\ |\\
    & \phi_{Match}(m) \land \\ & \forall x.\forall t.\forall y. m(x,t, y) > 0 \rightarrow x\in K\} \label{matchown}
  \end{eqnarray}
  Dabei definiert $\varphi_{Match}(m)$ die validen Matches:
  \begin{eqnarray}
    \varphi_{Match}(m) := \forall x.\forall t.(\sum_{y\in Baustelle} m(x,t,y))\leq supply(x,t)
  \end{eqnarray}
  Die Zeile (\ref{matchown}) sagt das nur solche Matches betrachtet werden, deren ''aktive'' Agenten auch teil der Koalition sind.
\end{definition}

\begin{definition}
  Sei K eine beliebige Koalition, dann definiert $B(K)$ die Menge der möglichen Baustellen, die von K gleichzeitig gebaut werden können.
  \begin{eqnarray}
    B(K) := \{ B_k\subseteq Baustelle\ |\\
    \exists m\in PM(K).\forall b\in B_k.\forall t.(\sum_{x\in K}m(x,t,b))\geq demand(b, t)\}
  \end{eqnarray}
\end{definition}

Da es sich um ein Simple Game handelt, Könenn wir o.B.d.A. annehmen, dass eine Agent nur einer Koalition zuzgeordnet ist:
\begin{equation}
  K\neq S \Rightarrow K\cap S =\emptyset \label{koalitiondisjunct}
\end{equation}

Hierraus folgt notwendigerweise, dass eine Baustelle in einem Spiel nur von einer Koalition gebaut werdenn kann, da diese pro Spiel nur einmal gebaut werden kann. Um dieses formal festzuhalten defenieren wir eine Outcome Relation:

\begin{definition}
  Seien K, S Koalitionen. Eine Outcome Menge weist beiden Koalitionen ein Tupel der Baustellen zu, die sie jeweils zur gleichen Zeit bauen können:
\begin{eqnarray}
  Outcome(K,S) := \{(B_K,B_S)\subseteq Baustelle\times Baustelle\ |\\B_K\in B(K) \land \\ B_S\in B(S)\land\\B_K\cap B_S =\emptyset \}
\end{eqnarray}
\end{definition}

Zur weiteren vereinfachung definieren wir uns noch eine Bewertungsfunktion für eine Menge von Baustellen:


\begin{definition}
  Sei $B\subseteq Baustelle$ beliebig. Dann definiert sich der wert von B:
  \begin{equation}
    v(B):=\sum_{b\in B} budget(b)
  \end{equation}
\end{definition}


\begin{definition}
  Nun können wir den Wert betrachten, die zwei Koalitionen erzielen können. Seien K,S beliebige Koalition:
\begin{eqnarray}
  v(K) + v(S) := \\\max_{(B_K, B_S)\in Outcome(K,S)}(v(B_K) - \varphi_{kosten}(K, B_K) + v(B_S) - \varphi_{kosten}(S, B_S))
\end{eqnarray}
Dadurch dass die Baustellen die von einer Koalition gebaut werden nicht mehr von einer anderen koalition gebaut werden können, müssen wir diese zeitgleich betrachten.\\
$\varphi_{kosten}(B,K)$ ist dabei die funktion, die basierend auf der vorhandenen Kostenfunktion, der Koalition und den Baustellen die kosten für die Koalition berechnet alle baustellen fertig zu stellen.
\textbf{Bemerkung}: Nach Definition ist das Ergebniss pareto effizient.
\end{definition}

Exestiert eine Koalition isoliert, lässt sich diese auch isoliert betrachten:
\begin{definition}
  Sei K eine beliebige Koalition.
  \begin{equation}
    v(K) := \max_{B'\in B(K)}(v(B') - \varphi_{kosten}(B', K))
  \end{equation}
\end{definition}

Insbesondere gilt dann auch für zwei allein agierende Koalitionen K,S:
\begin{equation}
  v(K\cup S) = \max_{B'\in B(K\cup S)}(v(B')-\varphi_{kosten}(B', K))
\end{equation}

Beachte auch das für einen Outcome zweier Koalitionen eine mögliche Baustellenmenge der potentiellen Baustellen der vereinigung der Koalitionen exestiert die alle Baustellen des seperaten Outcomes beinhaltet:
\begin{equation}
  \forall (B_K, B_S)\in Outcome(K,S).\exists B'\in B(K\cup S).B_K\cup B_S\subseteq B'
\end{equation}

Hierraus können wir die Superadditivität des Spiels schließen:
\begin{equation}
  v(K\cup S) \geq v(K) + v(S)
\end{equation}


Insbesondere ist das Spiel Konvex.
Nach einem Theorem (TODO) ist bei einem konvexen Spiel das Shapley Value im Core enthalten, sodass die beste Lösung dieses Spiels die große Koalition ist und eine stabile und faire Lösung immer exestiert.





% \section{Vorgehen}
% Zunächst werden wir versuchen unterschiedliche optimierungskritärien (utility) zu formulieren wie z.B. Optimierung der Gewinne aller Agenten. Oder optimieren der Gewinne bei gleichzeitiger minimierung der Kosten der Baustellen.
%
%
% \subsection*{Analysekritärien}
% Die Analysetechnik besteht nun darin folgende Fragen zu Formalisieren und gegebene Modelle darauf zu untersuchen:
%
% \begin{enumerate}
%   \item $\varphi_{\text{Optimal}}\Leftrightarrow$ Es exestiert kein Matching, das bez. der optimalitätskritärium besser währe.
%   \item $\varphi_{\text{pareto-effizient}}\Leftrightarrow$ Kein Spieler kann sich durch Manipulation seines Matchings verbessern.
%   \item Existenz von dummy und veto spielern
%   \item eindeutigkeit des optimums
% \end{enumerate}

% \begin{dot2tex}[dot,mathmode]
% graph G {
%       splines=false;
%       node[shape=circle, style=filled]
%       subgraph cluster_1 {
%       subgraph cluster_1r {
%          a12 [label="a"]
%          b12 [label="b"]
%          c12 [label="c"]
%          d12 [label="d"]
%          e12 [label="e"]
%          a12--b12--c12--d12--e12 [style=invis]
%          }
%       subgraph cluster_1l {
%          a11 [label="a"]
%          b11 [label="b"]
%          c11 [label="c"]
%          d11 [label="d"]
%          e11 [label="e"]
%          a11--b11--c11--d11--e11 [style=invis]
%          }
%          c11--a12 [constraint=false]
%          c11--b12 [constraint=false]
%          d11--b12 [constraint=false]
%          e11--a12 [constraint=false]
%          e11--b12 [constraint=false]
%      }
% }
% \end{dot2tex}


\end{document}
